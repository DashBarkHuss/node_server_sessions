<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
    <script>
    const makePayload = (payload)=>{
        return { method: 'post', 
        headers: {'Accept':'application/json'}, 
        body: JSON.stringify(payload)
        }
    }    
    const login = (payload) => {
        payload = makePayload(payload);
        fetch('http://127.0.0.1:3000/api/user/login', payload
            ).then(promise=>promise.json()
            ).then(content=> {
                console.log("content:",content)
                if(content.success==true){
                    return fetch("http://127.0.0.1:3000/api/session/create", payload)
                }
                throw content.message;
            }).then(promise=>promise.json()
            ).then(json=> {
                console.log(json)
                localStorage.setItem('token', json.token);

            }).catch((error) => { console.log("err:", error) });
    }
    const logout = (payload) => {
        localStorage.removeItem('token');
    }
    </script>
</head>
<body>
    <h2>Login</h2>
    <input type="text" id = "username"></input>
    <input type="password" id = "password"></input>
    <input type="button" value="Login" 
    onclick="login({'username':window.username.value, 'password': window.password.value})" >
    </input>

    <br>
    <input type="button" value="Logout" onclick="logout()"></input>
</body>
</html>